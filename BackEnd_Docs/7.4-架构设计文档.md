## Earn-Me-The-Money Architecture Document

| 版本 | 日期      | 描述                       | 作者      |
| ---- | --------- | -------------------------- | --------- |
| 0.1  | 2019.6.23 | 后端架构问题、解决方案说明 | Palette25 |



## 架构问题

### 服务端

#### 鉴权

由于服务端实际上接受的请求来自于奶牛用户，以及学生用户，所以不同种类的用户存在公用的API接口，也存在部分双方私有的API接口。并且，游客用户(即未注册登录的用户)不能使用大部分的功能API。考虑到这样的鉴权需要，须设定一个简单有效的鉴权方案。



#### 多核计算资源

在技术选型时，我们使用Rust语言进行服务端系统编写，同时结合其异步框架actix_web进行服务端的整体搭建，该框架所构成的服务端并行响应I/O请求速度较为优异，可以视作是一个比较有效的并行架构，一定程度上充分利用的服务器的多核计算资源，解决了负载均衡的问题。



#### 可扩展的架构

后端的整体构建参考MC结构，Model层交由数据库开发人员进行，Controller层交由服务端开发人员进行，分层结构显著，存在可扩展性。



#### 自动化测试与部署

结合curl工具，编写测试脚本进行服务端接口单元测试；部署采用docker工具进行，具体过程请关注部署文档。





## 解决方案说明

#### 鉴权

服务端在路由层中为不同接口指定鉴权权限，并且根据权限系数进行API权限划分：

1. `CommonAPI` ：公用API接口
2. `CowAPI`：奶牛专用API接口
3. `StudentAPI`：学生专用API接口
4. `BasicAPI`：游客与用户均可使用API接口



#### 可扩展的结构

在原本的MC架构上，添加了路由层`Router`，服务层`Service`，不同层负责的权职如下：

* `Router`：路由层，根据前端访问的API路径，路由到控制层的具体处理函数中
* `Controller`：控制层，处理HTTPS请求，收集请求参数，根据权限系数判断请求合法性，并调用服务层的对应函数
* `Service`：服务层，与数据库层进行交互，处理业务逻辑
* `Model`：数据库层，负责管理数据库内容



#### 自动化测试

由于源码托管在`GItHub`，因此采用`Travis CI`进行持续的自动化测试

